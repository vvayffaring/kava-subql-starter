{"version":3,"file":"model.js","sourceRoot":"","sources":["../../../../src/project/versioned/v0_3_0/model.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020-2022 OnFinality Limited authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\nimport {ProjectManifestBaseImpl} from '@subql/common';\nimport {SubqlCustomDatasource, SubqlCustomHandler, SubqlMapping, SubqlRuntimeHandler} from '@subql/types-flare';\nimport {plainToClass, Transform, TransformFnParams, Type} from 'class-transformer';\nimport {\n  Equals,\n  IsArray,\n  IsNotEmpty,\n  IsObject,\n  IsOptional,\n  IsString,\n  ValidateNested,\n  validateSync,\n} from 'class-validator';\nimport {CustomDataSourceBase, RuntimeDataSourceBase, EthereumMapping} from '../../models';\nimport {\n  CustomDatasourceV0_3_0,\n  EthereumProjectManifestV0_3_0,\n  RuntimeDataSourceV0_3_0,\n  SubqlMappingV0_3_0,\n} from './types';\n\nexport class FileType {\n  @IsString()\n  file: string;\n}\n\nexport class ProjectNetworkDeploymentV0_3_0 {\n  @IsString()\n  @IsNotEmpty()\n  @Transform(({value}: TransformFnParams) => value.trim())\n  genesisHash: string;\n}\n\nexport class ProjectNetworkV0_3_0 extends ProjectNetworkDeploymentV0_3_0 {\n  @IsString()\n  @IsOptional()\n  endpoint?: string | string[];\n  @IsString()\n  @IsOptional()\n  dictionary?: string;\n}\n\nexport class FileTypeV0_3_0 {\n  @IsString()\n  file: string;\n}\n\nexport class EthereumProjectMappingV0_3_0 extends EthereumMapping {\n  @IsString()\n  file: string;\n}\n\nexport class EthereumRuntimeDataSourceV0_3_0Impl\n  extends RuntimeDataSourceBase<SubqlMappingV0_3_0<SubqlRuntimeHandler>>\n  implements RuntimeDataSourceV0_3_0\n{\n  @Type(() => EthereumProjectMappingV0_3_0)\n  @ValidateNested()\n  mapping: SubqlMappingV0_3_0<SubqlRuntimeHandler>;\n}\n\nexport class EthereumCustomDataSourceV0_3_0Impl<\n    K extends string = string,\n    M extends SubqlMapping = SubqlMapping<SubqlCustomHandler>\n  >\n  extends CustomDataSourceBase<K, M>\n  implements SubqlCustomDatasource<K, M> {}\n\nexport class DeploymentV0_3_0 {\n  @Equals('0.3.0')\n  @IsString()\n  specVersion: string;\n  @ValidateNested()\n  @Type(() => FileType)\n  schema: FileType;\n  @IsArray()\n  @ValidateNested()\n  @Type(() => EthereumCustomDataSourceV0_3_0Impl, {\n    discriminator: {\n      property: 'kind',\n      subTypes: [\n        {value: EthereumRuntimeDataSourceV0_3_0Impl, name: 'flare/Runtime'},\n        {value: EthereumRuntimeDataSourceV0_3_0Impl, name: 'ethereum/Runtime'},\n      ],\n    },\n    keepDiscriminatorProperty: true,\n  })\n  dataSources: (RuntimeDataSourceV0_3_0 | CustomDatasourceV0_3_0)[];\n  @ValidateNested()\n  @Type(() => ProjectNetworkDeploymentV0_3_0)\n  network: ProjectNetworkDeploymentV0_3_0;\n}\n\nexport class ProjectManifestV0_3_0Impl\n  extends ProjectManifestBaseImpl<DeploymentV0_3_0>\n  implements EthereumProjectManifestV0_3_0\n{\n  @Equals('0.3.0')\n  specVersion: string;\n  @IsString()\n  name: string;\n  @IsString()\n  version: string;\n  @IsObject()\n  @ValidateNested()\n  @Type(() => ProjectNetworkV0_3_0)\n  network: ProjectNetworkV0_3_0;\n  @ValidateNested()\n  @Type(() => FileType)\n  schema: FileType;\n  @IsArray()\n  @ValidateNested()\n  @Type(() => EthereumCustomDataSourceV0_3_0Impl, {\n    discriminator: {\n      property: 'kind',\n      subTypes: [\n        {value: EthereumCustomDataSourceV0_3_0Impl, name: 'flare/Runtime'},\n        {value: EthereumCustomDataSourceV0_3_0Impl, name: 'ethereum/Runtime'},\n      ],\n    },\n    keepDiscriminatorProperty: true,\n  })\n  dataSources: (RuntimeDataSourceV0_3_0 | CustomDatasourceV0_3_0)[];\n  protected _deployment: DeploymentV0_3_0;\n\n  get deployment(): DeploymentV0_3_0 {\n    if (!this._deployment) {\n      this._deployment = plainToClass(DeploymentV0_3_0, this);\n      validateSync(this._deployment, {whitelist: true, forbidNonWhitelisted: true, forbidUnknownValues: true});\n    }\n    return this._deployment;\n  }\n}\n"]}