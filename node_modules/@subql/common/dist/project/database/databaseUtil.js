"use strict";
// Copyright 2020-2022 OnFinality Limited authors & contributors
// SPDX-License-Identifier: Apache-2.0
Object.defineProperty(exports, "__esModule", { value: true });
exports.getDbType = void 0;
const common_1 = require("@subql/common");
async function getDbType(queryFrom) {
    const result = await queryFrom.query('select version()');
    //  sequelize return an array,  Promise<[unknown[], unknown]
    //  pgPool return a single string object with rows
    const cleanResult = result instanceof Array ? result[0][0] : result.rows[0];
    const matchDB = Object.values(common_1.SUPPORT_DB).find((db) => cleanResult.version.includes(db));
    if (!matchDB) {
        throw new Error(`Database type not supported, got ${result}`);
    }
    return matchDB;
}
exports.getDbType = getDbType;
//# sourceMappingURL=databaseUtil.js.map